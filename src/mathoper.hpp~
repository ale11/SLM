#ifndef MATHOPER_H
#define MATHOPER_H

#include <math.h>

inline double vecDotMatDotVec3d(double *v1, double *v2, double (*M)[3])
{
  double result = 0.0;

  for (int i = 0; i < 3; i++)
    for (int j = 0; j < 3; j++)
      result += v1[i]*M[i][j]*v2[j];

  return result;
}

inline void matDotVec3d(double *v1, double *v2, double (*M)[3])
{
  for (int i = 0; i < 3; i++)
  {
    v1[i] = 0.0;
    for (int j = 0; j < 3; j++)
      v1[i] += M[i][j]*v2[j];
  }
}

inline void matTransDotVec3d(double *v1, double *v2, double (*M)[3])
{
  for (int i = 0; i < 3; i++)
    {
      v1[i] = 0.0;
      for (int j = 0; j < 3; j++)
	v1[i] += M[j][i]*v2[j];
    }
}

inline void matPlusMat3d(double (*M1)[3], double (*M2)[3], double (*M3)[3])
{
  for (int i = 0; i < 3; i++)
    for (int j = 0; j < 3; j++)
      M1[i][j] = M2[i][j] + M3[i][j];
}

#endif
